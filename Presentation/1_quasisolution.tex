\begin{frame}
    \frametitle{Граничная обратная задача}
    Модель имеет следующий вид
    \begin{wrapfigure}{r}{0.3\textwidth}
        \centering{\includegraphics[width=1\linewidth]{omega_1}}
    \end{wrapfigure}
    \begin{gather}
        \label{eq:2_1:initial}
        - a \Delta \theta + b \kappa_a(\theta ^{4} - \varphi) = 0, \\
        - \alpha \Delta \varphi + \kappa_a (\varphi - \theta ^4) = 0,
    \end{gather}
    \begin{equation}
        \label{eq:2_1:initial-boundary}
        \begin{aligned}
            \Gamma &: \; a \partial_n \theta + \beta (\theta - \theta _{out}) = 0, \\
            \Gamma_0 \cup \Gamma_2 &: \; \alpha \partial_n \varphi
            + \gamma(\varphi - \theta_{out} ^4 ) = 0, \\
            \Gamma_1 &: \; \alpha \partial_n \varphi + u(\varphi - \theta_{out} ^4 ) = 0. \\
        \end{aligned}
    \end{equation}
    $\Gamma_0, \Gamma_1, \Gamma_2$ не имеют пересечений.

    Функции $\gamma, \theta_{out}, \beta$ известны.
    \textit{Неизвестная функция $u$ характеризует отражающие свойства участка границы $\Gamma_1$}.
    Предполагается, что $0 < u_1 \leq u \leq u_2$.

    \textbf{Обратная задача} заключается в отыскании тройки $\theta, \varphi, u$
    по дополнительному условию $\theta|_{\Gamma_2} = \theta_0$.

    \textbf{Экстремальная задача} заключается в минимизации функционала
    \begin{equation}
        \label{eq:2_1:quality}
        J(\theta) = \frac{1}{2} \int_{\Gamma_2} (\theta - \theta_0)^2 d\Gamma
    \end{equation}
    на решениях краевой задачи~\eqref{eq:2_1:initial}--\eqref{eq:2_1:initial-boundary}.
\end{frame}
\note{
    \begin{itemize}
        \item Первая из рассматриваемых задач ставится следующим образом ---
        у объекта на части границы неизвестны отражательная способность поверхности -- на рисунке представлена снизу.
        \item Требуется найти состояние и неизвестный параметр обладая дополнительной информацией
        о температурном поле на границе (верхний участок).
        \item Задача усложняется тем, что неизвестный параметр обладает естественными физическими ограничениями.
        \item Это есть рассматриваемая обратная задача.
        Об этой задаче нет данных по корректности.
        Как и нет известных методов её решения.
        \item В работе предложено заменить её на задачу оптимального управления,
        которая заключается в минимизации функционала 4 на решениях краевой задачи 1-3.
        \item \textbf{Квазирешение}, Доказано существование квазирешения, доказана сходимость к решению обратной задачи.
    \end{itemize}

    \vspace{3em}
    \textit{физический смысл: восстанавливаем граничные условия излучения по замерам температуры на части границы.}
}


\begin{frame}
    \frametitle{Нахождение квазирешения обратной задачи}
    \begin{gather}
        A_1 \theta + b \kappa_a (| \theta | \theta^3 - \varphi) =
        f, A_2 \varphi + \kappa_a (\varphi - |\theta|\theta^3) + F(\varphi, u) = g.
        \label{eq:2_1:weakOperational}\\
        J(\theta) = \frac{1}{2} \int_{\Gamma_2} (\theta - \theta_0)^2 d\Gamma,
        \label{eq:2_1:qualityOperational}\\
        A_1 p_1 + 4 |\hat{\theta}|^3 \kappa_a(b p_1 - p_2) = f_c,
        \;\; (f_c,v) = - \int_{\Gamma_2} (\hat{\theta} - \theta_0) v d\Gamma,
        \label{eq:2_1:theorem_2_eq1}\\
        A_2 p_2 + \kappa_a (p_2-b p_1) = g_c(p_2, \hat{u}),
        \;(g_c(p_2, \hat{u}), v) = -\int_{\Gamma_1} \hat{u} p_2 v d\Gamma,
        \label{eq:2_1:theorem_2_eq2}\\
        \int_{\Gamma_1} p_2 (\hat{\varphi} - \theta_{out}^4)(u-w) d\Gamma
        \leq 0 \quad \forall w \in U_{ad}. \label{eq:2_1:theorem_2_eq3}
    \end{gather}
    \textbf{Алгоритм градиентного спуска с проекцией}
    \begin{enumerate}
        \item Выбор шага $\lambda$, числа итераций $N$, управления $u_0 \in U_{ad}$
        -- пространство допустимых управлений.
        \item для $k \leftarrow 0,1,2, \ldots, N$ выполнить:
        \begin{itemize}
            \item Для $u_{k}$, вычислить $y_k = \{\theta_k, \varphi_k\}$ из~\eqref{eq:2_1:weakOperational}.
            \item Вычислить значение $J(\theta_k)$ из уравнения~\eqref{eq:2_1:qualityOperational}.
            \item Рассчитать $p_k=\{p_{1k},p_{2k}\}$
            из~\eqref{eq:2_1:theorem_2_eq1}--\eqref{eq:2_1:theorem_2_eq2},
            \item Пересчитать управление
            $u_{k+1} = P_{ad}\left[ u_k - \lambda (\varphi_k - \theta_{out}^4)p_{2k} \right]$.
        \end{itemize}
    \end{enumerate}
\end{frame}
\note{
    \begin{itemize}
        \item Предложенный в работе алгоритм поиска квазирешения обратной задачи основан
        на выведенных условиях оптимальности -- представлены на слайде.
        \item Сам алгоритм градиентного спуска с проекцией также представлен на слайде.
        \item Обратим внимание, что оператор проекции нужен
        из-за начальных ограничений на функцию управления (вызванных физ.\ огр.\ параметра).
        \item Выбор градиентного метода обусловлен диффузионной природой модели,
        возможностью контроля по итерациям, простотой реализации относительно других методов, и возможностью модификации (проекция).
        \item Отметим, что в силу невыпуклости экстремальных задач градиентные алгоритмы не
        обладают свойством глобальной сходимости, что служит почвой для их критики.
        \item Однако свойства диффузионных моделей сложного теплообмена, правильный выбор шага градиентного спуска,
        а также начального приближения решения обеспечивают сходимость для рассматриваемых задач.
        \item Следующие примеры этот факт демонстрируют.
    \end{itemize}
}

\begin{frame}
    \textbf{Численные эксперименты:}

    \begin{wrapfigure}{r}{0.3\textwidth}
        \centering{\includegraphics[width=1\linewidth]{omega_1}}
%        \caption*{$\Gamma \coloneqq \partial \Omega =\overline{\Gamma}_0 \cup \overline{\Gamma}_1 \cup \overline{\Gamma}_2$}
    \end{wrapfigure}
    Положим $\Omega = \{(x,y), 0 \leq x,y \leq 1\}$, $l = 1$ см.
    Граница $\partial\Omega$:
    \[
        \begin{aligned}
            \Gamma_0 & = \{x=\{0,1\}, y \in [0,1]\} \\
            \Gamma_1 & = \{x\in [0,1], y=0\}
            - \text{участок с неизвестными отр. свойствами}, \\
            \Gamma_2 & = \{x \in [0,1], y=1\} - \text{участок наблюдения}.
        \end{aligned}
    \]
    Будем также далее считать, что $a = 0.006[\text{см}^2/\text{c}]$,
    $b=0.025[\text{см}/\text{с}]$, $\beta = 0.00005[\text{см}/\text{с}]$,
    $\kappa=1[\text{см}^{-1}]$, $\kappa_s = 0$, $A = 0$, $\gamma = 0.3$.
    Температуру на границе $\Omega$ положим равной $\theta_b = (x^2+y^2)/3$.

    При указанных параметрах для первого эксперимента выберем следующее тестовое
    значение функции $u$:
    \begin{equation*}
        u(x)=
        \begin{cases}
            0.01, & \text{если } x \le 0.5, \\
            0.5, & \text{если } x > 0.5,
        \end{cases}
    \end{equation*}
    и для второго эксперимента:
    $u(x)=0.49x+0.01$.
    \\
    Из решения краевой задачи получим $\theta_0$,
    которая будет использована в функционале качества.
\end{frame}
\note{
    \begin{itemize}
        \item Стеклянный параллелепипед, у которого боковые стороны ``обычные'', верхняя грань - участок наблюдения,
        нижняя грань - участок с функцией управления.
        \item Положим параметры среды, соответствующие стеклу и зададим тестовую функцию управления
        как показано на слайде -- два эксперимента.
        \item Для заранее известной функции управления рассчитаем состояние, и температуру
        с доступной границы положим в ф.\ качества.
    \end{itemize}
    \vspace{2em}
    Данные параметры соответствуют кварцевому стеклу или силикатному расплаву при температурах $\sim 1000$--$1400^\circ$C:
    низкая температуропроводность $a \approx 6 \times 10^{-7}$~м$^2$/с, отсутствие рассеяния ($\kappa_s = 0$)
    и коэффициент поглощения $\kappa = 100$~м$^{-1}$ обеспечивают оптическую толщину
    порядка нескольких единиц на сантиметровом масштабе.
}


\begin{frame}
    \textbf{Результаты моделирования:}

    \centering
    \includegraphics[width=0.42\linewidth]{dvmg368/1}
    \includegraphics[width=0.42\linewidth]{dvmg368/2}
    \includegraphics[width=0.42\linewidth]{dvmg368/3}
    \includegraphics[width=0.42\linewidth]{dvmg368/4}
\end{frame}
\note{
    \begin{itemize}
        \item На верхних графиках представлен результат работы алгоритма, на нижних -- динамика функционала качества.
        \item Эффект среднего значения -- в силу природы диффузионных моделей оптимизационный
        алгоритм сначала восстанавливает усреднённый температурный профиль.
        \item Далее скорость сходимости уменьшается по итерациям, пытаясь уловить уже ``нюансы'' решения.
        \item Полученные результаты свидетельствуют о том, что предложенный алгоритм успешно справляется с предложенной задачей.
    \end{itemize}
}

\begin{frame}
    \frametitle{Задача без краевых условий для интенсивности излучения}
    \textbf{Краевая задача:}
    \begin{equation}
        \label{eq:2_2:eq1}
        - a \Delta \theta + b \kappa_a(\theta ^ 3 | \theta | - \varphi) = 0,  \quad
        - \alpha \Delta \varphi + \kappa_a (\varphi - \theta ^3 | \theta |) = 0,
    \end{equation}
    На $\Gamma$ известно температурное поле и тепловой поток:
    \begin{equation}
        \label{eq:2_2:bc2} \theta = \theta_b, \quad \partial_n\theta = q_b.
    \end{equation}
    Заменяем на <<искусственные>> краевые условия
    \begin{equation}
        \label{eq:2_2:bc3}
        a(\partial_n\theta+\theta) = r,\;\;
        \alpha(\partial_n\varphi+\varphi) = u \text{ на }\Gamma.
    \end{equation}
    Функция $r(x),\, x\in\Gamma$ является заданной, функция $u(x),\, x\in\Gamma$
    описывающая излучающие свойства участка границы, неизвестна.
    Получаем \textbf{обратную задачу}.

    \textbf{Задача оптимального управления} заключается в отыскании тройки
    $\{\theta_\lambda,\varphi_\lambda,u_\lambda\}$ такой, что
    \begin{equation}
        \label{eq:2_2:cost}
        J_\lambda(\theta, u) = \frac{1}{2}\int\limits_\Gamma (\theta - \theta_b)^2 d\Gamma
        + \frac{\lambda}{2}\int\limits_\Gamma u^2 d\Gamma \rightarrow\inf
    \end{equation}
    на решениях краевой задачи, функция $u(x), \, x \in \Gamma$ играет роль управления.

    \begin{itemize}
        \item $(j) \;\; a,b,\alpha,\kappa_a, \lambda ={\textrm Const}> 0,$
        \item $(jj) \;\, \theta_b, \,q_b \in U,\;\; r=a(\theta_b+q_b)$.
    \end{itemize}
    \begin{theorem}[2.5]
        \label{th:2_2:3}
        Пусть выполняются условия $(j),(jj)$ и существует решение
        задачи~\eqref{eq:2_2:eq1}--\eqref{eq:2_2:bc2}.
        Если $\{\theta_\lambda,\varphi_\lambda,u_\lambda\}$ -- решение
        задачи оптимального управления для $\lambda>0$, то существует последовательность $\lambda\to +0$
        такая, что
        $\theta_\lambda\rightarrow\theta_*, \;\; \varphi_\lambda\rightarrow\varphi_*
        \text{ слабо в }H^1,\text{ сильно в }L^2$,
        где $\theta_*,\varphi_*$ -- решение задачи~\eqref{eq:2_2:eq1}--\eqref{eq:2_2:bc2}.
    \end{theorem}
\end{frame}
\note{
    \begin{itemize}
        \item На слайде первая из рассмотренных задач с условиями типа Коши.
        Известна только температура и тепловой поток, тогда как информация по внешней среде отсутствует.
        \item Разрешимость подобной постановки была доказана в 2019 году (АЮ Чеботарёв).
        \item Однако способ нахождения решения, а также его теоретическое обоснование представлено в диссертации.
        \item Для нахождения решения предлагается используя замену (12) получить обратную задачу (при неизвестном параметре для излучения).
        \item Задача же \textbf{оптимального управления} заключается в минимизации функционала (13) на решениях краевой задачи.
        \item Наиболее важный результат - сходимость решений экстремальных
        задач к решению исх.\ задачи, при уменьшении параметра регуляризации.
    \end{itemize}

    \vspace{1em}

    \textit{Сильная сходимость в $L^2$ -- это сходимость по норме $\|\cdot\|_{L^2}$,
        где норма определяется как квадратный корень из интеграла квадрата разности:
        $\left(\int_\Omega |\theta_\lambda - \theta^*|^2 \, dx \,\right)^{1/2} \to 0$.
    }
    \textit{Поскольку $H^1$ гильбертово, то оно самосопряженное.}


    Сл.\ сх.\ в $H^1$ — это одновременно:
    сл.\ сх.\ самой функции в $L^2$, сл.\ сх.\ градиентов в $L^2$.


    \textit{Слабая сходимость в $V$ означает, что $\theta_\lambda \rightharpoonup \theta^*$ слабо в $H^1(\Omega)$,
        т.е. $\forall$ тестовой $v \in V$ выполняется
        $\int_\Omega \nabla \theta_\lambda \cdot \nabla v \, dx \to \int_\Omega \nabla \theta^* \cdot \nabla v \, dx$
        (и аналогично для $\varphi_\lambda$). }
}


\begin{frame}
    \textbf{Разрешимость задачи оптимального управления и условия оптимальности}

    \begin{theorem}[2.3]
        \label{th:2_2:1}
        Пусть выполняются условия $(j), (jj)$.
        Тогда существует решение задачи оптимального управления.
    \end{theorem}
    \begin{theorem}[2.4]
        \label{th:2_2:2}
        Пусть выполняются условия $(j),(jj)$.
        Если $\{\hat{\theta}, \hat{\varphi}, \hat{u}\}$ -- решение задачи оптимального управления,
        то существует единственная пара $\{p_1, p_2 \} \in V\times V$ такая, что
        \begin{equation}
            \label{eq:2_2:as}
            aAp_1 +4|\hat{\theta}|^3 \kappa_a(bp_1 - p_2) = B(\theta_b - \hat{\theta}), \;\;
            \alpha A p_2 + \kappa_a (p_2 - b p_1)=0
        \end{equation}
        и при этом $\lambda\hat{u} = p_2$.
    \end{theorem}


    \textbf{Алгоритм решения задачи без краевых условий для интенсивности излучения}

    1.\ Выбираем значение градиентного шага $\varepsilon$,

    2.\ Выбираем количество итераций $N$,

    3.\ Выбираем начальное приближение для управления $u_{0} \in U$,

    4.\ для $k \leftarrow 0,1,2, \ldots, N$ выполнить:

    \hspace{1cm} a.\ Для заданного $u_{k}$, вычислить состояние
    $y_{k}=\left\{\theta_{k}, \varphi_{k}\right\}$, решение
    задачи~\eqref{eq:2_2:eq1}--\eqref{eq:2_2:bc3}.

    \hspace{1cm} b.\ Вычислить значение функционала качества
    $J_{\lambda}\left(\theta_{k}, u_{k}\right)$.

    \hspace{1cm} c.\ Из уравнений~\eqref{eq:2_2:as}, вычислить сопряженное
    состояние $p_{k}=\left\{p_{1k}, p_{2k}\right\}$,
    где $\widehat{\theta} \coloneqq \theta_{k}, \widehat{u} \coloneqq u_{k}$.

    \hspace{1cm} d.\ Пересчитать управление
    $u_{k+1}=u_{k}-\varepsilon\left(\lambda u_{k}-p_{2}\right)$.


    Значение параметра $\varepsilon$ выбирается эмпирически.
    Количество итераций $N$ выбирается достаточным для выполнения условия
    $J_\lambda(\theta_k, u_k) - J_\lambda(\theta_{k+1}, u_{k+1}) < \delta$, где $\delta>0$
    определяет точность расчетов.
\end{frame}
\note{
    - Теорема 2.3: при выполнении условий (j), (jj) доказана разрешимость задачи оптимального управления.\\
    - Теорема 2.4: для решения задачи оптимального управления выведена система условий оптимальности первого порядка.\\
    - Система включает сопряжённые уравнения и условие на управление: $\lambda \hat u = p_2$.
    - Полученные условия оптимальности служат основой для построения численного градиентного алгоритма.
}

\begin{frame}
    \textbf{Численное моделирование.}
    Приведем примеры расчетов для куба $\Omega = {(x, y, z), 0 \leq x,y,z \leq l}$.
    Будем считать, что $l=1~\text{см}$, $a = 0.006[\text{см}^2/\text{c}]$,
    $b=0.025[\text{см}/\text{с}]$, $\kappa_a=1[\text{см}^{-1}]$, $\alpha = 0.(3)[\text{см}]$.
    Параметр регуляризации $\lambda=10^{-12}$.\\


    Зададим функции $\theta_{b}, q_{b}$ в краевом условии~\eqref{eq:2_2:bc2}
    следующим образом:
    \[
        \theta_{b}=0.1 z+0.3, \quad q_{b}=
        \begin{cases}
            0.11, & \text { если } z=1, \\
            0, & \text { если } 0<z<1, \\
            -0.15, & \text { если } z=0.
        \end{cases}
    \]

    \textbf{Начальное значение функционала качества} $J_\lambda$ составляет $7.20 \cdot 10^{-6}$.
    Финальное значение $2.86 \cdot 10^{-10}$.

    \begin{figure}[h!t]
        \begin{minipage}[b][][b]{0.49\linewidth}
            \centering
            \includegraphics[width=0.9\linewidth]{jvm-2020/dvmg/3b}
            \\ а) Полученное температурное поле $\theta_\lambda$
        \end{minipage}
        \hfill
        \begin{minipage}[b][][b]{0.49\linewidth}
            \centering
            \includegraphics[width=1\linewidth]{jvm-2020/dvmg/2a}
            \\ б) Полученное поле излучения $\varphi_\lambda$
        \end{minipage}
        \label{fig:4_4:3}
    \end{figure}

\end{frame}
\note{
    - Область: стеклянный куб, параметры указаны на слайде. \\
    - Температура на границе задаётся линейно по оси $z$, нормальная производная температуры - константы. \\
    - Параметр регуляризации очень мал. \\
    - Результаты: - Начальное значение функционала $10^{-6}$. - Финальное значение $10^{-10}$. \\
    - Полученное поле температуры соответствует заданному с высокой точностью, хотя фигурирует только в функционале качества. \\
    - Поле излучения физически осмысленно и согласуется с моделью. \\
    - Вывод: алгоритм обеспечивает высокую точность восстановления решения при минимальной регуляризации. \\
}
