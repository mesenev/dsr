\section{Численные алгоритмы решения прямых задач сложного теплообмена}
\label{sec:ch4/sec1}
Стационарная модель сложного теплообмена
в $P_1$ приближении записывается как
\[
    \begin{gathered}
        -a \Delta \theta+b \kappa_{a}| \theta|^{3} \theta =
        b \kappa_{a} \varphi \\
        -\alpha \Delta \varphi+\kappa_{a} \varphi =
        \kappa_{a}|\theta|^{3} \theta \\
        a \frac{\partial \theta}{\partial n}
        +\left.\beta\left(\theta-\theta_{b}\right)\right|_{\Gamma}=0,
        \quad \alpha \frac{\partial \varphi}{\partial n}
        +\left.\gamma\left(\varphi-\theta_{b}^{4}\right)\right|_{\Gamma}=0.
    \end{gathered}
\]

Основную сложность в решении прямой задачи представляет компонент
температурного поля, который входит в систему
дифференциальных уравнений с четвёртой степенью.

Метод простой итераций применяется для решения задач в двумерной области.
Он был использован в работах~\cite{Kovtanyuk2015,astrakhantseva2014numerical}.
Однако, в трёхмерной области этот метод демонстрирует недостаточную сходимость,
что приводит к долгим итерационным процессам и увеличению вычислительных затрат.

Вместо метода простой итераций для решения сложных задач оптимального управления
температурой может быть применен метод Ньютона.
Метод Ньютона является одним из наиболее эффективных методов оптимизации
и решения нелинейных уравнений.
Он использует локальную аппроксимацию функции в виде касательной плоскости
и обновляет решение на основе градиента и гессиана функции.
Этот метод обычно обеспечивает быструю сходимость и может быть
применен для решения сложных задач оптимального
управления температурой в трехмерных областях.


Метод Ньютона является усовершенствованным вариантом метода простой итерации,
в котором нелинейное слагаемое $|\theta|^3 \theta$ аппроксимируется
выражением $\widetilde{\theta}^4+4 \widetilde{\theta^3}(\theta-\widetilde{\theta})$.
Эта аппроксимация обеспечивает более точное решение и быструю сходимость,
что делает метод Ньютона более эффективным для
решения задач с высокой степенью нелинейности.
В результате модифицированная система уравнений примет следующий вид:

\[
    \begin{gathered}
        -a \Delta \theta+b \kappa_{a}\left(\left(4 \widetilde{\theta}^{3}
        \theta-3 \widetilde{\theta}^{4}\right)-\varphi\right)=0,
        \quad-\alpha \Delta \varphi
        +\kappa_{a}\left(\varphi
        -\left(4 \widetilde{\theta}^{3}
        \theta-3 \widetilde{\theta}^{4}\right)\right)=0, \\
        a \frac{\partial \theta}{\partial n}
        +\left.\beta\left(\theta-\theta_{b}\right)\right|_{\Gamma}=0,
        \quad \alpha \frac{\partial \varphi}{\partial n}
        +\left.\gamma\left(\varphi-\theta_{b}^{4}\right)\right|_{\Gamma}=0.
    \end{gathered}
\]

Монотонная сходимость метода Ньютона является важным свойством,
которое позволяет обеспечить стабильность итерационного процесса
и успешное решение эллиптических уравнений
с монотонным и выпуклым нелинейным слагаемым.
В литературе было проведено множество исследований, направленных
на изучение сходимости метода Ньютона для таких уравнений.

В частности, в работах~\cite{Mukhamadiev1971, Schryer1971} были представлены
результаты анализа монотонной сходимости метода Ньютона для эллиптического
уравнения с монотонным и выпуклым нелинейным слагаемым.
Результаты этих исследований показывают, что метод Ньютона обладает
хорошими свойствами сходимости и может быть применен для решения
сложных задач оптимального управления в моделях сложного теплообмена.

Далее приведём некоторые численные методы решения краевых задач.

\subsection{Методы конечных элементов}
\label{subsec:ch4/sec1/fem}

Метод конечных элементов (МКЭ, \textit{англ. FEM}) — это мощный численный метод решения
дифференциальных уравнений в частных производных (УЧП), возникающих
в различных инженерных и научных приложениях.
Это универсальный и гибкий метод, который позволяет анализировать
сложные геометрические формы, свойства материалов и условия нагрузки.
В данном разделе представлен обзор существующих методов, включая математические
формулировки, шаги по реализации вычислительных алгоритмов,
а также применение МКЭ в различных областях.

\textbf{Математическая формулировка}
Метод конечных элементов начинается с преобразования определяющих
уравнений математической физики в их слабую форму, которая затем дискретизируется
в систему алгебраических уравнений.
Слабая формулировка получается путем умножения основного уравнения
на тестовую функцию и последующего интегрирования по рассматриваемой области.
Полученная система алгебраических уравнений решается для получения
неизвестных переменных в дискретных точках,
называемых узлами, внутри области.


\textbf{Слабая формулировка}

Рассмотрим общую краевую задачу, описываемую следующим УЧП:

\begin{equation*}
    \mathcal{L}u=f
\end{equation*}

где $\mathcal{L}$ — линейный дифференциальный оператор,
$u$ — неизвестная функция, $f$ — исходный член.
Чтобы получить слабую форму этого уравнения,
умножим обе части на тестовую функцию
$v$ и проинтегрируем по области $\Omega$:

\begin{equation*}
    \int_{\Omega} v \mathcal{L}u d\Omega = \int_{\Omega} vf d\Omega.
\end{equation*}

Применяя интегрирование по частям и учитывая соответствующие
граничные условия, мы получаем слабую форму уравнения.

\textbf{Дискретизация}

Область $\Omega$ необходимо дискретизировать на конечное число подобластей,
называемых элементами, которые соединены в узлах.
Неизвестная функция $u$ аппроксимируется внутри каждого
элемента набором базисных функций:

\begin{equation*}
    u(\mathbf{x}) \approx u_h(\mathbf{x}) = \sum_{i=1}^{n} N_i(\mathbf{x}) u_i,
\end{equation*}
где $N_i$ — функции формы, а $u_i$ — узловые значения неизвестной функции.
Функции формы выбираются так, чтобы они удовлетворяли разбиению единицы
и обладали свойством $N_i(\mathbf{x}j)=\delta{ij}$,
где $\delta_{ij}$ — дельта Кронекера.

Подставив приближенную функцию $u_h$ в слабую формулировку и применив
метод Галеркина, полученную систему линейных
уравнений можно записать в матричном виде:

\begin{equation*}
    \mathbf{K} u = F,
\end{equation*}

где $\mathbf{K}$ — матрица жесткости, $u$ — вектор
неизвестных узловых значений, $F$ — вектор силы. %TODO: какой силы ёпта чё за бред

\textbf{Реализация}

\textit{Генерация сетки.}
Первым шагом в реализации МКЭ является построение сетки,
включающее дискретизацию области $\Omega$ на конечное число элементов.
Качество сетки значительно влияет на точность
и эффективность решения методами конечных элементов.
Существуют различные типы элементов, такие как треугольники,
четырехугольники, тетраэдры и шестигранники, и выбор типа элемента
зависит от геометрии задачи и желаемой точности.

\textit{Функции формы и интерполяция.}
Функции формы используются для интерполяции неизвестной
функции $u$ внутри каждого элемента.
Они определены таким образом, что равны единице в соответствующих
узлах и нулю во всех остальных узлах.
В зависимости от требуемой
точности и гладкости решения могут использоваться линейные,
квадратичные функции и функции формы более высокого порядка.
Выбор функций формы зависит от типа используемого элемента и желаемой
непрерывности решения по границам элементов.

\textit{Сборка.}
После определения функций формы следующим шагом является сборка
глобальной матрицы жесткости $\mathbf{K}$ и вектора силы $F$
из вкладов отдельных элементов.

Это включает в себя сопоставление матриц и векторов локальных
элементов с их соответствующими глобальными
позициями на основе связности между элементами.
Процесс сборки приводит к разреженной линейной системе
из-за локализованного характера функций формы.

\textit{Граничные условия.}
Для решения линейной системы необходимо
применить соответствующие граничные условия.
Существует два основных типа граничных условий:
граничные условия Дирихле, которые задают значение
неизвестной функции на границе, и граничные условия Неймана,
которые задают производную неизвестной функции на границе.
Граничные условия применяются путем изменения матрицы
жесткости и вектора силы, чтобы обеспечить выполнение заданных условий.

\textit{Решение.}
После того, как глобальная матрица жесткости и вектор силы собраны
и применены граничные условия, линейная система
$\mathbf{K} u = F$ может быть решена с использованием
различных прямых или итерационных методов решения, такие как исключение Гаусса,
метод сопряженных градиентов или метод предварительно обусловленных сопряженных градиентов.
Вектор решения $u$ предоставляет неизвестные значения функции в узлах,
из которых решение может быть интерполировано в пределах
каждого элемента с использованием функций формы.

\textbf{Приложения}
Метод конечных элементов получил широкое распространение в различных
областях благодаря своей гибкости и универсальности.
Некоторые распространенные приложения МКЭ включают:
\begin{itemize}
    \item Структурный анализ: МКЭ широко используется для анализа напряжений
    и деформаций в конструкциях при различных условиях нагрузки, включая
    статические, динамические и тепловые нагрузки.
    \item Гидродинамика: метод используется для решения сложных задач о
    потоках жидкости, таких как несжимаемые и сжимаемые потоки, турбулентные
    потоки и многофазные потоки.
    \item Теплопередача: МКЭ используется для анализа теплопроводности,
    конвекции и излучения в твердых телах и жидкостях.
    \item Электромагнетизм: метод применим для анализа электромагнитных
    полей в различных приложениях, таких как волноводы,
    антенны и электромагнитное экранирование.
    \item Геомеханика: МКЭ используется для изучения поведения грунтов
    и горных пород в различных геотехнических и геологических
    приложениях, таких как устойчивость откосов,
    прокладка туннелей и сейсморазведка.
\end{itemize}

\textbf{Заключение}
Метод конечных элементов — это мощный численный метод решения
дифференциальных уравнений в частных производных, возникающих
в различных инженерных и научных приложениях.
Метод включает в себя преобразование основных уравнений
в их слабую форму, дискретизацию области на конечное число
элементов, аппроксимацию неизвестной функции с использованием
функций формы и решение полученной линейной системы.
FEM широко используется во многих областях
благодаря своей гибкости, точности и способности
работать со сложной геометрией, свойствами
материалов и условиями нагрузки.
Несмотря на свои многочисленные преимущества, метод конечных
элементов также имеет некоторые ограничения,
такие как необходимость создания высококачественной сетки,
потенциальные трудности с применением граничных условий
и вычислительные затраты,связанные с решением больших линейных систем.
Однако постоянное развитие передовых численных методов,
эффективных алгоритмов и высокопроизводительных вычислительных
ресурсов продолжает расширять область применения
и возможности МКЭ, делая его незаменимым инструментом при
анализе и проектировании сложных систем
в различных областях науки и техники.

\subsection{Методы конечных разностей}
\label{subsec:ch4/sec1/mfd}

Метод конечных разностей (FDM) — широко используемый численный метод
решения уравнений в частных производных (УЧП) в различных
областях науки и техники.
Этот метод включает дискретизацию интересующей области на конечное
число узлов сетки и аппроксимацию производных в основных уравнениях
с использованием конечных разностей.
В этом отчете мы предоставим обзор метода конечных разностей,
обсудим основные концепции и
представим некоторые соответствующие математические формулы.

\textbf{Конечно-разностные аппроксимации}

Основная идея метода конечных разностей состоит в том, чтобы
аппроксимировать производные в уравнении в частных производных,
используя аппроксимации конечных разностей.
Например, рассмотрим функцию $u(x)$,
определенную над областью определения $[a, b]$.
Производная первого порядка от $u(x)$ может быть аппроксимирована
прямой разностью, обратной разностью или центральной разностью.
Аппроксимация прямой разности определяется выражением

\begin{equation*}
    \frac{du(x)}{dx} \ приблизительно \frac{u(x + h) - u(x)}{h},
\end{equation*}

где $h$ — небольшое положительное число, часто
называемое размером шага или шагом сетки.

Аппроксимация обратной разности определяется выражением
\begin{equation*}
    \frac{du(x)}{dx} \ приблизительно \frac{u(x) - u(x - h)}{h}.
\end{equation*}

Аппроксимация центральной разности, которая обычно более точна,
чем разность прямая или обратная разность, определяется выражением
\begin{equation*}
    \frac{du(x)}{dx} \approx \frac{u(x + h) - u(x - h)}{2h}.
\end{equation*}

Производные более высокого порядка также
можно аппроксимировать с помощью конечных разностей.
Например, производная второго порядка может
быть аппроксимирована формулой центральной разности:

\begin{equation*}
    \frac{d^2 u(x)}{dx^2} \approx \frac{u(x + h) - 2u(x) + u(x - h)}{h^2}.
\end{equation*}

\textbf{Дискретизация уравнений в частных производных}

Чтобы проиллюстрировать применение метода конечных разностей
при решении уравнений в частных производных, рассмотрим одномерное
стационарное уравнение теплопроводности:

\begin{equation*}
    \frac{d}{dx}\left(k \frac{du}{dx}\right) = q(x),
\end{equation*}

где $u(x)$ — температура, $k$ — теплопроводность,
$q(x)$ — член источника тепла.

\textit{Дискретизация области.}
Первым шагом в методе конечных разностей является
дискретизация области $[a, b]$ на конечное число узлов сетки.
Пусть $N$ будет количеством узлов сетки, и пусть
$x_i = a + i \Delta x$, $i = 0, 1, \ldots, N - 1$, будут узлами сетки,
где $\Delta x = (b - a) / (N - 1)$ - шаг сетки.

\textit{Дискретизация основного уравнения.}
Затем мы дискретизируем основное уравнение в каждой точке сетки $x_i$,
используя конечно-разностные приближения.
Например, производная второго порядка в уравнении теплопроводности
может быть аппроксимирована формулой центральной разности:

\begin{equation*}
    \frac{d^2 u(x_i)}{dx^2} \approx \frac{u(x_{i+1}) - 2u(x_i) + u(x_{i-1})}{\Delta x^2}.
\end{equation*}

Следовательно, дискретизированная форма уравнения теплопроводности
в узловой точке $x_i$ может быть записана как
\begin{equation*}
    \frac{d}{dx}\left(k \frac{u(x_{i+1}) - u(x_{i-1})}{2\Delta x}\right) = q(x_i).
\end{equation*}

\textit{Граничные условия.}
Для получения единственного решения дискретизированной
задачи необходимо наложить соответствующие граничные условия.
В контексте метода конечных разностей можно применять два
типа граничных условий: граничные условия Дирихле,
задающие значения зависимой переменной $u(x)$ на границах,
и граничные условия Неймана, задающие значения нормальных
производных $\frac{du(x)}{dx}$ на границах.

Например, предположим, что граничные условия для
задачи теплопроводности имеют вид

\begin{equation*}
    u(a) = u_0 \quad \text{и} \quad \frac{du(b)}{dx} = g,
\end{equation*}

где $u_0$ — известная константа,
$g$ — тепловой поток на границе $x = b$.
Граничное условие Дирихле при $x = a$ может быть
включено непосредственно в дискретизированную задачу.
Граничное условие Неймана при $x = b$ можно аппроксимировать
односторонней разностной формулой:

\begin{equation*}
    \frac{du(b)}{dx} \approx \frac{u(b) - u(b - \Delta x)}{\Delta x} = g.
\end{equation*}

\textbf{Решение дискретизированной задачи}

После дискретизации основного уравнения и наложения граничных
условий получаем систему линейных алгебраических уравнений вида
\begin{equation*}
    A\mathbf{u} = \mathbf{b},
\end{equation*}
где $A$ — матрица, содержащая коэффициенты дискретизированной
задачи, $\mathbf{u}$ — вектор неизвестных температур в узлах сетки,
$\mathbf{b}$ — вектор известных членов, включая граничные
условия и термин источника тепла.

Система линейных алгебраических уравнений может быть решена с
использованием различных численных методов, таких как метод
Гаусса-Зейделя, метод Якоби или метод сопряженных градиентов.
После получения вектора решения $\mathbf{u}$ поле температур в
области может быть восстановлено путем интерполяции температур в узлах сетки.

\textbf{Заключение}

В данной главе мы представили обзор метода конечных разностей
для решения уравнений в частных производных.
Метод включает в себя дискретизацию области на конечное число
узлов сетки и аппроксимацию производных в основных уравнениях
с использованием конечных разностей.
Полученная система линейных
алгебраических уравнений может быть решена с использованием различных
численных методов для получения решения исходной задачи.
