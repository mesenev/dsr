\section{Метод штрафных функций для решения задачи
оптимального управления с финальным наблюдением}
\label{sec:ch3:sec3}
%Chebotarev_Park_Mesenev_Kovtanyuk_22.pdf
%Penalty method to solve an optimal control problem for a qasilinear parabolic equation

%
%\subsection{Введение}\label{subsec:ch3:sec3:subsec1}
%
Рассмотрим задачу оптимального управления моделирующую процесс
внутривенной лазерной абляции в ограниченной трехмерной области
$\Omega$ с отражающей границей $\Gamma=\partial\Omega$.

Задача заключается в минимизации функционала
\[
    J(\theta)=\int_{G_{d}}\left(\left.\theta\right|_{t=T}
    -\theta_{d}\right)^{2} d x \rightarrow \inf,
\]
на решениях начально-краевой задачи
\begin{gather}
    \label{eq:3_3:1}
    \sigma \partial \theta / \partial t-\operatorname{div}(k(\theta) \nabla \theta)
    -\beta \varphi=u_{1} \chi, \\
    \quad-\operatorname{div}(\alpha \nabla \varphi)+\beta \varphi= u_{2} \chi,
\end{gather}
\begin{gather}
    \label{eq:3_3:2}
    k(\theta) \partial_{n} \theta+\left.\gamma
    \left(\theta-\theta_{b}\right)\right|_{\Gamma}=0,
    \quad \alpha \partial_{n} \varphi +
    \left.0.5 \varphi\right|_{\Gamma}=0,\left.\quad \theta\right|_{t=0}=\theta_{0}.
%        \quad x \in \Omega, \quad 0<t<T, \\
\end{gather}
Также будем учитывать следующие ограничения:
\[
    u_{1,2} \geq 0, \quad u_{1}+u_{2} \leq P,\left.\quad \theta\right|_{G_{b}} \leq \theta_{*}.
\]
Здесь $\theta$ - температура, $\varphi$ - интенсивность излучения, усредненная по всем направлениям,
$\alpha$ - коэффициент диффузии оптического излучения, $\mu_{a}$ - коэффициент поглощения,
$k(\theta)$ - коэффициент теплопроводности, $\sigma(x, t)$ произведение удельной теплоемкости
и объемной плотности, $u_{1}$ описывает мощность источника, затрачиваемую
на нагрев наконечника волокна, $u_{2}$ - мощность источника, затрачиваемая на излучение,
$\chi$ равно характеристической функции части среды, в которой расположен наконечник волокна,
деленной на объем наконечника волокна.
Функции $\theta_{b}, \theta_{0}$ определяют граничное и начальное распределения температуры.

Требуется обеспечить близость распределения температуры к желаемому температурному полю $\theta_{d}$
в конечный момент времени $t=T$ в подобласти $G_{d}$, при этом температура в подобласти $G_{b}$
не превышает постоянного критического значения значение $\theta_{*}$.

\subsection{Формализация задачи оптимального управления}\label{subsec:ch3:sec3:subsec2}

В дальнейшем мы предполагаем, что $\Omega $ является ограниченной Липшицевой областью,
$\Gamma =\partial \Omega, Q =\Omega \times(0, T)$, $\Sigma=\Gamma \times(0, T)$.

\begin{definition}
    Пусть $u_{1,2} \in L^{2}(0, T)$.
    Пара $\theta, \varphi \in L^{2}(0, T ; V)$ слабое решение задачи~\eqref{eq:3_3:1}-\eqref{eq:3_3:2} если
    $\sigma \theta^{\prime} \in L^{2}\left(0, T ; V^{\prime}\right)$ и
    \begin{equation}
        \label{eq:3_3:3}
        \sigma \theta^{\prime}+A(\theta)-\beta \varphi=g+u_{1} \chi,
        \quad \theta(0)=\theta_{0}, \quad B \varphi=u_{2} \chi,
    \end{equation}
    где
    \[
        \theta^{\prime}=d \theta / d t, \quad g \in L^{\infty}\left(0, T ; V^{\prime}\right),
        \quad(g, v)=\int_{\Gamma} \gamma \theta_{b} v d \Gamma.
    \]
\end{definition}

\begin{remark}
    Так как $(\sigma \theta)^{\prime}=\sigma \theta^{\prime}+\theta
    \partial \sigma / \partial t \in L^{2}\left(0, T ; V^{\prime}\right)$ and $\sigma
    \theta \in L^{2}(0, T ; V)$, тогда $\sigma \theta \in$ $C([0, T] ; H)$,
    и поэтому начальные условия имеют смысл.
\end{remark}

Из леммы Лакса-Мильграма следует, что для любой функции $g \in H$ существует единственное
решение уравнения $B\varphi= g$.
Более того, обратный оператор $B^{-1}: H \rightarrow V$ является непрерывным.
Следовательно, мы можем исключить интенсивность излучения $\varphi=u_{2} B^{-1} \chi$
и сформулировать задачу оптимального управления следующим образом.


\textbf{Задача} $CPP$.
\[
    \begin{gathered}
        J(\theta)=\int_{G_{d}}\left(\left.\theta\right|_{t=T}
        - \theta_{d}\right)^{2} d x \rightarrow \inf,
        \quad \sigma \theta^{\prime}+A(\theta)=g+u, \quad \theta(0)=\theta_{0}, \\
        \left.\theta\right|_{G_{b}} \leq \theta_{*}, \quad u \in U_{a d}.
    \end{gathered}
\]
Здесь
\[
    U_{a d}=\left\{u=u_{1} \chi+u_{2} \beta B^{-1} \chi: u_{1,2} \in L^{2}(0, T), u_{1,2}
    \geq 0, u_{1}+u_{2} \leq P\right\}.
\]

\subsection{Предварительные результаты}
\label{subsec:ch3:sec3:subsec3}

\begin{lemma}[\cite{kovtanyuk2021mathematical}]
    \label{lm:3_3:1}
    Пусть условия $(c1)$-$(c4)$ выполняются и
    $u \in L^{2}\left(0, T ; V^{\prime}\right)$.
    Тогда есть решение задачи
    \begin{equation}
        \label{eq:3_3:4}
        \sigma \theta^{\prime}+A(\theta)=g+u, \quad \theta(0)=\theta_{0},
    \end{equation}
    такое, что $\theta \in L^{\infty}(0, T ; H)$, а также верна следующая оценка:
    \[
        \|\theta(t)\|^{2}+\|\theta\|_{L^{2}\left(0, T ; V^{\prime}\right)}^{2}
        \leq C\left(\left\|\theta_{0}\right\|^{2}+\|g+u\|_{L^{2}
        \left(0, T; V^{\prime}\right)}^{2}\right),
    \]
    где $C>0$ не зависит от $\theta_{0}, g$, $u$.
\end{lemma}

\begin{lemma}
    \label{lm:3_3:2}
    Пусть условия $(c1)$-$(c4)$ выполняются, $u=0, \theta_{0} \leq \theta_{*}$ почти всюду
    в $\Omega, \theta_{b} \leq \theta_{*}$ почти всюду в $\Sigma$, и $\theta$ есть
    решение задачи~\eqref{eq:3_3:4}.
    Тогда $\theta \leq \theta_{*}$ почти всюду в $\Omega \times(0, T)$.
\end{lemma}

\begin{proof}
    Умножая скалярно в $H$ первое уравнение в~\eqref{eq:3_3:4} на
    $v=\max \left\{\theta-\theta_{*}, 0\right\}\in L^{2}(0, T; V)$, мы получаем
    \[
        \left(\sigma v^{\prime}, v\right)+(k(\theta) \nabla v, \nabla v)
        + \int_{\Gamma} \gamma \theta v d \Gamma=0.
    \]

    Отбрасывая неотрицательные второе и третье слагаемые, мы приходим к оценке
    \[
        \frac{d}{d t}(\sigma v, v) \leq\left(\sigma_{t} v, v\right) \leq \sigma_{2}\|v\|^{2}.
    \]

    Интегрируя последнее неравенство по времени и принимая во внимание,
    что $\left.v\right|_{t=0}=0$, мы получаем
    \[
        \sigma_{0}\|v(t)\|^{2} \leq(\sigma v(t), v(t))
        \leq \sigma_{2} \int_{0}^{t}\|v(\tau)\|^{2} d \tau
    \]
    Основываясь на лемме Гронуолла, мы приходим к выводу, что $v=0$ и, следовательно,
    $\theta \leq \theta_{*}$ в $\Omega \times(0, T)$.
\end{proof}

Леммы~\ref{lm:3_3:1} и~\ref{lm:3_3:2} влекут
непустоту множества допустимых пар задачи $CPP$
и ограниченность минимизирующей последовательности допустимых пар
$\left\{\theta_{m}, u_{m}\right\} \in L^{2}(0, T ; V) \times$
$U_{a d}$ так, что $J\left(\theta_{m}\right) \rightarrow j=\inf J$, где
\begin{equation}
    \label{eq:3_3:5}
    \sigma \theta_{m}^{\prime}+A\left(\theta_{m}\right)=g+u_{m},
    \quad \theta_{m}(0)=\theta_{0},\left.\quad \theta_{m}\right|_{G_{b}} \leq \theta_{*}.
\end{equation}

Аналогично разделу~\ref{th:3_2:1}, переходя к пределу в системе~\eqref{eq:3_3:5},
можно установить разрешимость задачи $CPP$\@.

\begin{theorem}
    \label{th:3_3:1}
    Пусть условия $(c1)$-$(c4)$ выполняются,
    $\theta_{0} \leq \theta_{*}$ п.\ в. в $\Omega, \theta_{b} \leq \theta_{*}$ п.\ в. в $\Sigma$.
    Тогда решение задачи $CPP$ существует.
\end{theorem}

\subsection{Метод штрафных функций}\label{subsec:ch3:sec3:subsec4}
Рассмотрим следующую задачу оптимального управления с параметром $\varepsilon>0$,
решения которой аппроксимируют решение задачи $CPP$ при $\varepsilon \rightarrow+0$.


\textbf{Задача} $CPP_{\varepsilon}$.
\[
    \begin{gathered}
        J_{\varepsilon}(\theta)=\int_{G_{d}}
        \left(\left.\theta\right|_{t=T}
        -\theta_{d}\right)^{2} d x
        + \frac{1}{\varepsilon} \int_{0}^{T} \int_{G_{b}} F(\theta) d x d t \rightarrow \inf \\
        \sigma \theta^{\prime}+A(\theta)=g+u, \quad \theta(0)=\theta_{0}, \quad u \in U_{a d}
    \end{gathered}
\]
Здесь,
\[
    F(\theta)=
    \begin{cases}
        0, & \text { если } \theta \leq \theta_{*}, \\
        \left(\theta-\theta_{*}\right)^{2}, & \text { если } \theta>\theta_{*}
    \end{cases}
\]

Оценки, представленные в лемме~\ref{lm:3_3:1}, позволяют, аналогично
доказательству теоремы~\ref{th:3_3:1}, доказать разрешимость задачи со штрафом.
\begin{theorem}
    \label{th:3_3:2}
    Пусть выполняются условия $(c1)$-$(c4)$.
    Тогда существует решение задачи $CPP_{\varepsilon}$.
\end{theorem}

Рассмотрим аппроксимирующие свойства решений задачи со штрафом.
Пусть $\left\{\theta_{\varepsilon}, u_{\varepsilon}\right\}$ решение задачи
$\left(\mathrm{CPP}_{\varepsilon}\right)$ и $\{\theta, u\}$ решение задачи $CPP$.
Тогда,
\begin{equation}
    \label{eq:3_3:6}
    \sigma \theta_{\varepsilon}^{\prime}
    + A\left(\theta_{\varepsilon}\right)=g + u_{\varepsilon},
    \quad \theta_{\varepsilon}(0) = \theta_{0}.
\end{equation}
Так как $\left.\theta\right|_{G_{b}} \leq \theta_{*}$, верны следующие неравенства:
\[
    \int_{G_{d}}\left(\left.\theta_{\varepsilon}\right|_{t=T}-\theta_{d}\right)^{2} d x \leq J(\theta),
    \quad \int_{0}^{T} \int_{G_{b}} F\left(\theta_{\varepsilon}\right) d x d t \leq \varepsilon J(\theta).
\]


Из полученных оценок, используя при необходимости подпоследовательности в качестве
$\varepsilon \rightarrow+0$, аналогично, как и в доказательстве теоремы~\ref{th:3_3:1},
мы можем доказать существование функций
$\widehat{u} \in U_{a d}, \widehat{\theta} \in L^{2}(0, T ; V)$ таких, что

$u_{\varepsilon} \rightarrow \widehat{u}$ слабо в
$L^{2}(0, T ; H), \theta_{\varepsilon} \rightarrow \widehat{\theta}$ слабо в $L^{2}(0, T ; V)$,
сильно в $L^{2}(0, T ; H)$;
\[
    \int_{0}^{T} \int_{G_{b}} F\left(\theta_{\varepsilon}\right) d x d t \rightarrow \int_{0}^{T}
    \int_{G_{b}} F(\widehat{\theta}) dx dt\text { и }\int_{0}^{T} \int_{G_{b}}
    F\left(\theta_{\varepsilon}\right) dx dt \rightarrow 0
    \text{ при } \varepsilon \rightarrow+0
\]

Следовательно, $F(\widehat{\theta})=0$ и
$\left.\widehat{\theta}\right|_{G_{b}} \leq \theta_{*}$.

Результатов о сходимости достаточно, чтобы перейти к пределу при $\varepsilon \rightarrow+0$
в системе~\eqref{eq:3_3:6} и доказать, что предельная пара
$\{\widehat{\theta}, \widehat{u}\} \in$ $L^{2}(0, T ; V) \times U_{a d}$
является допустимой для задачи $CPP$.
Поскольку функционал $J$ является слабо полунепрерывным снизу, то
\[
    j \leq J(\widehat{\theta}) \leq \liminf J\left(\theta_{\varepsilon}\right) \leq J(\theta)=j=\inf J.
\]
Тогда пара $\{\widehat{\theta}, \widehat{u}\}$ решение задачи $CPP$.
\begin{theorem}
    Пусть выполняются условия $(c1)$-$(c4)$,
    $\theta_{0} \leq \theta_{*}$ п.\ в. в $\Omega, \theta_{b} \leq \theta_{*}$ п.\ в. в
    $\Sigma$.
    Если $\left\{\theta_{\varepsilon}, u_{\varepsilon}\right\}$ решения задачи
    $\left(C P_{\varepsilon}\right)$ для $\varepsilon>0$, тогда существует последовательность
    $\varepsilon \rightarrow+0$ такая, что $u_{\varepsilon} \rightarrow \widehat{u}$ слабо в
    $L^{2}(0, T ; H), \, \theta_{\varepsilon} \rightarrow \widehat{\theta}$
    слабо в $L^{2}(0, T ; V)$, сильно в $L^{2}(0, T ; H)$, где
    $\{\widehat{\theta}, \widehat{u}\}$ есть решение задачи $CPP$.
\end{theorem}
